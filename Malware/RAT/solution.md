# Solution
- Download the rat.7z file.
- Unzip the file.
```bash
7z e rat7z
```
- Run the command file.
```bash
file rat
```

![Alt text](image.png)

- Move the "rat" executable on a Windows machine and open it with dnSpy (https://github.com/dnSpy/dnSpy). Looking at PopIT Stub, there is a "decrypt" method. Add a breakpoint and let the program run.

![Alt text](image-1.png)

- When the breakpoint is hit, expand the "result" variable and save the value in another file called "stage2".

![Alt text](image-2.png)

- Open "stage2" with dnSpy and notice the flag variable encrypted. The encryption/decryption method is in the Client.Algorithm namespace.

![Alt text](image-3.png)

![Alt text](image-4.png)

- Copy the encrypted flag value. Set a breakpoint at line 19 in Program under Client namespace.

![Alt text](image-5.png)

Set another breakpoint at the Decrypt function in AES256 under the Client.Algorithm namespace.

![Alt text](image-6.png)

- Let the program run. "Step into" when the first breakpoint is hit.

![Alt text](image-7.png)

Change the "input" variable to the encrypted flag when the second breakpoint is hit.

![Alt text](image-8.png)

- Let the program run and get the flag from the returned value.

![Alt text](image-9.png)

- Uploading "rat" executable in Virus Total or Hybrid Analysis can lead to the flag disclosure as well.

